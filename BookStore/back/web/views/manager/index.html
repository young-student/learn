<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>后台管理</title>
    <link rel="stylesheet" href="../../assets/layui/css/layui.css">
    <link rel="stylesheet" href="../../assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../assets/css/index.min.css">
</head>

<body class="layui-layout-body">
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header">
            <div class="layui-logo">图书商城后台</div>
            <ul class="layui-nav layui-layout-right">
                <li class="layui-nav-item">
                    <a href="javascript:;" class="admin-name">
                        <img src="../../assets/img/bg.jpg" class="layui-nav-img">
                        <span></span>
                    </a>
                </li>
                <li class="layui-nav-item"><a href="javascript:;">退出</a></li>
            </ul>
        </div>

        <div class="layui-side layui-bg-black">
            <div class="layui-side-scroll">
                <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
                <ul class="layui-nav layui-nav-tree" lay-filter="test">
                    <li class="layui-nav-item layui-nav-itemed">
                        <a class="user-link" href="javascript:;">用户管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" class="adduser">添加用户</a></dd>
                            <dd><a href="javascript:;">列表二</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a class="book-link" href="javascript:;">图书商品管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;" class="addbook">添加图书商品</a></dd>
                            <dd><a href="javascript:;">列表二</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a class="order-link" href="javascript:;">订单管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;">列表一</a></dd>
                            <dd><a href="javascript:;">列表二</a></dd>
                        </dl>
                    </li>
                </ul>
            </div>
        </div>

        <div class="layui-body">
            <!-- 内容主体区域 -->
            <div class="user">
                <div class="container">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>用户名</th>
                                <th>邮箱</th>
                                <th>创建日期</th>
                                <th>修改日期</th>
                            </tr>
                        </thead>
                        <tbody id="user">
                        </tbody>
                    </table>
                    <div class="page">
                        <div id="pageuser"></div>
                    </div>
                </div>
            </div>
            <div class="add userlist">
                <div class="close"></div>
                <form action="/manager/add/user" method="post" target="nm_iframe" required="required">
                    <div class="add-input">
                        <label for="username">用户名:</label>
                        <input type="text" id="username" name="username">
                    </div>
                    <div class="add-input">
                        <label for="password">密码:</label>
                        <input type="text" id="password" name="password">
                    </div>
                    <div class="add-submit">
                        <a href="javascript:;">
                            <input type="submit" name="" id="usersub" value="添 加">
                        </a>
                    </div>
                </form>
            </div>
            <div class="book">
                <div class="container">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>书名</th>
                                <th>作者</th>
                                <th>价格</th>
                                <th>销量</th>
                                <th>库存</th>
                                <th>操作</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="tbd">
                        </tbody>
                    </table>
                    <div class="page">
                        <div id="pagebook"></div>
                    </div>
                </div>
            </div>
            <div class="add booklist">
                <div class="close"></div>
                <form action="/manager/book/add" method="post" target="nm_iframe" required="required">
                    <div class="add-input">
                        <label for="cover">封面:</label>
                        <input type="text" id="cover" name="cover">
                    </div>
                    <div class="add-input">
                        <label for="title">书名:</label>
                        <input type="text" id="title" name="title">
                    </div>
                    <div class="add-input">
                        <label for="author">作者:</label>
                        <input type="text" id="author" name="author">
                    </div>
                    <div class="add-input">
                        <label for="prices">价格:</label>
                        <input type="text" id="prices" name="price">
                    </div>
                    <div class="add-input">
                        <label for="sale">销量:</label>
                        <input type="text" id="sale" name="sale">
                    </div>
                    <div class="add-input">
                        <label for="stock">库存:</label>
                        <input type="text" id="stock" name="stock">
                    </div>
                    <div class="add-submit">
                        <a href="javascript:;">
                            <input type="submit" name="" id="booksub" value="添 加">
                        </a>
                    </div>
                </form>
            </div>
            <div class="add updatebook">
                <div class="close"></div>
                <form action="/manager/book/update" method="post" target="nm_iframe" required="required">
                    <div class="add-input" hidden>
                        <label for="book_id">编号:</label>
                        <input type="text" id="book_id" name="id">
                    </div>
                    <div class="add-input">
                        <label for="title">书名:</label>
                        <input type="text" id="title" name="title">
                    </div>
                    <div class="add-input">
                        <label for="author">作者:</label>
                        <input type="text" id="author" name="author">
                    </div>
                    <div class="add-input">
                        <label for="prices">价格:</label>
                        <input type="text" id="prices" name="price">
                    </div>
                    <div class="add-input">
                        <label for="sale">销量:</label>
                        <input type="text" id="sale" name="sale">
                    </div>
                    <div class="add-input">
                        <label for="stock">库存:</label>
                        <input type="text" id="stock" name="stock">
                    </div>
                    <div class="submit-box">
                        <a href="javascript:;">
                            <input type="submit" name="" id="sure" value="确 定">
                        </a>
                        <a href="javascript:;">
                            <input type="reset" name="" id="reset" value="重 置">
                        </a>
                    </div>
                </form>
            </div>
            <!-- 订单列表 -->
            <div class="order">
                <div class="container">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>用户</th>
                                <th>订单号</th>
                                <th>订单日期</th>
                                <th>商品数量</th>
                                <th>总金额</th>
                                <th>详情</th>
                            </tr>
                        </thead>
                        <tbody id="ord">

                        </tbody>
                    </table>
                </div>
                <div class="page">
                    <div id="pageorder"></div>
                </div>
            </div>
            <!-- 订单详情 -->
            <div class="order-info">
                <div class="close-info"></div>
                <div class="container">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>书名</th>
                                <th>作者</th>
                                <th>数量</th>
                                <th>价格</th>
                                <th>金额</th>
                            </tr>
                        </thead>
                        <tbody id="detail">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <iframe id="id_iframe" name="nm_iframe" style="display:none;"></iframe>
        <div class="layui-footer">
            底部固定区域
        </div>
    </div>
    <script src="../../assets/layui/layui.all.js"></script>
    <script src="../../assets/js/jquery.min.js"></script>
    <script src="../../assets/js/index.min.js"></script>
    <script>
        function upd(id) {
            $(".updatebook").css("display", "block");
            var inputs = $(".updatebook").find("input");
            $.ajax({
                type: "post",
                url: "http://29759g4o70.imdo.co:32515/manager/getBookID",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({ "id": parseInt(id) }),
                dataType: "json",
                success: function (resp) {
                    // console.log(resp);
                    inputs.eq(0).val(resp.id);
                    inputs.eq(1).val(resp.title);
                    inputs.eq(2).val(resp.author);
                    inputs.eq(3).val(resp.price);
                    inputs.eq(4).val(resp.sales);
                    inputs.eq(5).val(resp.stock);
                },
                error: function (resp) {
                    // console.log(resp);
                }
            });
        }
        function del(id) {
            window.confirm("你确定要删除该图书商品？");
            $.ajax({
                type: "post",
                url: "http://29759g4o70.imdo.co:32515//manager/book/delete",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({ id: parseInt(id) }),
                dataType: "json",
                success: function (resp) {
                    // console.log(resp);
                    alert(resp);
                    window.location.reload();
                },
                error: function (resp) {
                    // console.log(resp);
                }
            });
        }
        function detail(id) {
            $(".order-info").css("display", "block");
            $(".order").css("display", "none");
            $.ajax({
                type: "post",
                url: "http://29759g4o70.imdo.co:32515/manager/orderItem/info",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({ order_id: id }),
                dataType: "json",
                success: function (resp) {
                    console.log(resp);
                    var html = [];
                    for (var i = 0; i < resp.length; i++) {
                        html.push(
                            `<tr>
                                <td>${resp[i].title}</td>
                                <td>${resp[i].author}</td>
                                <td>${resp[i].count}</td>
                                <td>${resp[i].price}</td>
                                <td>${resp[i].amount}</td>
                            </tr>`
                        );
                    }
                    $("#detail").html(html.join(''));
                },
                error: function (resp) {
                    // console.log(resp);
                }
            });
        }
    </script>
</body>

</html>